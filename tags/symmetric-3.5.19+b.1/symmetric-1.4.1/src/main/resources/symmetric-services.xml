<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"
    default-lazy-init="true">
    
    <import resource="classpath:/sql/*-service-sql.xml"/>
    
    <bean id="dbDialect" class="org.jumpmind.symmetric.db.DbDialectFactory" scope="singleton">
        <property name="jdbcTemplate" ref="jdbcTemplate" />
    </bean>
    
    <bean id="statisticService" class="org.jumpmind.symmetric.service.impl.StatisticService">
        <property name="sql" ref="statisticServiceSql"/>
        <property name="jdbcTemplate" ref="jdbcTemplate" />        
    </bean>
    
    <bean id="statisticManager" class="org.jumpmind.symmetric.statistic.StatisticManager">
        <property name="statisticService" ref="statisticService"/>
        <property name="nodeService" ref="nodeService"/>
        <property name="notificationService" ref="notificationService"/>
        <property name="parameterService" ref="parameterService"/>
    </bean>
    
    <bean id="concurrentConnectionManager" class="org.jumpmind.symmetric.transport.ConcurrentConnectionManager">
        <property name="statisticManager" ref="statisticManager"/>
        <property name="parameterService" ref="parameterService"/>
    </bean>

    <bean id="transportManager" class="org.jumpmind.symmetric.transport.TransportManagerFactoryBean"
        scope="singleton">
        <property name="nodeService" ref="nodeService" />
        <property name="parameterService" ref="parameterService" />
    </bean>

    <bean id="bootstrapService" class="org.jumpmind.symmetric.service.impl.BootstrapService"
        scope="singleton">
        <property name="triggerPrefix" value="${trigger.prefix}" />
        <property name="tablePrefix" value="${sync.table.prefix}" />
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="parameterService" ref="parameterService" />
        <property name="nodeService" ref="nodeService" />
        <property name="dbDialect" ref="dbDialect" />        
        <property name="configurationService" ref="configurationService" />
        <property name="registrationService" ref="registrationService" />
        <property name="dataService" ref="dataService" />
        <property name="upgradeService" ref="upgradeService" />
        <property name="clusterService" ref="clusterService" />
    </bean>

    <bean id="parameterService" class="org.jumpmind.symmetric.service.impl.ParameterService"
        scope="singleton">
        <property name="sql" ref="parameterServiceSql" />
        <property name="jdbcTemplate" ref="jdbcTemplate" />
    </bean>

    <bean id="configurationService" class="org.jumpmind.symmetric.service.impl.ConfigurationService"
        scope="singleton">
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="parameterService" ref="parameterService" />
        <property name="dbDialect" ref="dbDialect" />
        <property name="sql" ref="configurationServiceSql"/>
        <property name="rootConfigChannelInitialLoadSelect" ref="rootConfigChannelInitialLoadSelect"/>
        <property name="rootConfigChannelTableNames">
            <list>
                <value>${sync.table.prefix}_node_group</value>
                <value>${sync.table.prefix}_node_group_link</value>
                <value>${sync.table.prefix}_node</value>
                <value>${sync.table.prefix}_node_security</value>
                <value>${sync.table.prefix}_parameter</value>
                <value>${sync.table.prefix}_channel</value>
                <value>${sync.table.prefix}_node_channel_ctl</value>
                <value>${sync.table.prefix}_trigger</value>
            </list>
        </property>
    </bean>

    <bean id="outgoingBatchService" class="org.jumpmind.symmetric.service.impl.OutgoingBatchService"
        scope="singleton">
        <property name="sql" ref="outgoingBatchServiceSql"/>
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="parameterService" ref="parameterService" />
        <property name="configurationService" ref="configurationService" />        
        <property name="nodeService" ref="nodeService" />
        <property name="statisticManager" ref="statisticManager" />        
        <property name="dbDialect" ref="dbDialect" />
    </bean>

    <bean id="dataExtractorService"
        class="org.jumpmind.symmetric.service.impl.DataExtractorService">
        <property name="sql" ref="dataExtractorServiceSql"/>
        <property name="outgoingBatchService" ref="outgoingBatchService" />
        <property name="configurationService" ref="configurationService" />
        <property name="parameterService" ref="parameterService" />
        <property name="dbDialect" ref="dbDialect" />
        <property name="tablePrefix" value="${sync.table.prefix}" />
        <property name="context" ref="extractorContext" />
        <property name="jdbcTemplate" ref="jdbcTemplate" />
    </bean>

    <bean id="dataService" class="org.jumpmind.symmetric.service.impl.DataService"
        scope="singleton">
        <property name="sql" ref="dataServiceSql"/>
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="configurationService" ref="configurationService" />
        <property name="parameterService" ref="parameterService" />
        <property name="nodeService" ref="nodeService" />
        <property name="outgoingBatchService" ref="outgoingBatchService" />
        <property name="purgeService" ref="purgeService" />
        <property name="dbDialect" ref="dbDialect" />
        <property name="tablePrefix" value="${sync.table.prefix}" />
    </bean>

    <bean id="pushService" class="org.jumpmind.symmetric.service.impl.PushService">
        <property name="extractor" ref="dataExtractorService" />
        <property name="transportManager" ref="transportManager" />
        <property name="parameterService" ref="parameterService" />
        <property name="dataService" ref="dataService" />
        <property name="ackService" ref="acknowledgeService" />
        <property name="nodeService" ref="nodeService" />
    </bean>

    <bean id="pullService" class="org.jumpmind.symmetric.service.impl.PullService">
        <property name="registrationService" ref="registrationService" />
        <property name="dataLoaderService" ref="dataLoaderService" />
        <property name="nodeService" ref="nodeService" />
        <property name="bootstrapService" ref="bootstrapService" />
        <property name="parameterService" ref="parameterService" />
    </bean>

    <bean id="dataLoaderService" class="org.jumpmind.symmetric.service.impl.DataLoaderService"
        scope="singleton">
        <property name="dbDialect" ref="dbDialect" />
        <property name="transactionTemplate" ref="transactionTemplate" />
        <property name="transportManager" ref="transportManager" />
        <property name="incomingBatchService" ref="incomingBatchService" />
        <property name="statisticManager" ref="statisticManager" />
        <property name="parameterService" ref="parameterService" />
        <property name="nodeService" ref="nodeService" />
    </bean>

    <bean id="dataLoader" class="org.jumpmind.symmetric.load.csv.CsvLoader" scope="prototype">
        <property name="dbDialect" ref="dbDialect" />
        <property name="jdbcTemplate" ref="dataLoaderTemplate" />
        <property name="configurationService" ref="configurationService" />
        <property name="nodeService" ref="nodeService" />
        <property name="parameterService" ref="parameterService" />
    </bean>

    <bean id="incomingBatchService" class="org.jumpmind.symmetric.service.impl.IncomingBatchService"
        scope="singleton">
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="dbDialect" ref="dbDialect" />
        <property name="sql" ref="incomingBatchServiceSql"/>
        <property name="parameterService" ref="parameterService" />
    </bean>

    <bean id="nodeService" class="org.jumpmind.symmetric.service.impl.NodeService"
        scope="singleton">
        <property name="sql" ref="nodeServiceSql"/>
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="parameterService" ref="parameterService" />
    </bean>

    <bean id="registrationService" class="org.jumpmind.symmetric.service.impl.RegistrationService"
        scope="singleton">
        <property name="sql" ref="registrationServiceSql"/>
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="nodeService" ref="nodeService" />
        <property name="clusterService" ref="clusterService" />
        <property name="acknowledgeService" ref="acknowledgeService" />
        <property name="dataExtractorService" ref="dataExtractorService" />
        <property name="configurationService" ref="configurationService" />
        <property name="dbDialect" ref="dbDialect" />        
        <property name="transportManager" ref="transportManager" />
        <property name="dataLoaderService" ref="dataLoaderService" />        
        <property name="parameterService" ref="parameterService" />
        <property name="dataService" ref="dataService" />
    </bean>

    <bean id="acknowledgeService" class="org.jumpmind.symmetric.service.impl.AcknowledgeService"
        scope="singleton">
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="outgoingBatchService" ref="outgoingBatchService" />
        <property name="parameterService" ref="parameterService" />
        <property name="sql" ref="acknowledgeServiceSql"/>
    </bean>

    <bean id="extractorContext" class="org.jumpmind.symmetric.extract.DataExtractorContext"
        scope="prototype">
    </bean>

    <bean id="dataExtractor" class="org.jumpmind.symmetric.extract.csv.CsvExtractor">
        <property name="dbDialect" ref="dbDialect" />
        <property name="parameterService" ref="parameterService" />
        <property name="nodeService" ref="nodeService" />
        <property name="dictionary">
            <map>
                <entry key="I">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamInsertDataCommand"></bean>
                </entry>
                <entry key="U">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamUpdateDataCommand"></bean>
                </entry>
                <entry key="D">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamDeleteDataCommand"></bean>
                </entry>
                <entry key="V">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamValidateDataCommand"></bean>
                </entry>
                <entry key="R">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamReloadDataCommand">
                        <property name="dataExtractorService" ref="dataExtractorService" />
                        <property name="configurationService" ref="configurationService" />
                        <property name="nodeService" ref="nodeService" />
                    </bean>
                </entry>
                <entry key="S">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamSQLDataCommand"></bean>
                </entry>
                <entry key="C">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamCreateDataCommand"></bean>
                </entry>
            </map>
        </property>
    </bean>

    <bean id="dataExtractor13" class="org.jumpmind.symmetric.extract.csv.CsvExtractor13">
        <property name="dbDialect" ref="dbDialect" />
        <property name="parameterService" ref="parameterService" />
        <property name="tablePrefix" value="${sync.table.prefix}" />
        <property name="dictionary">
            <map>
                <entry key="I">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamInsertDataCommand"></bean>
                </entry>
                <entry key="U">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamUpdateDataCommand"></bean>
                </entry>
                <entry key="D">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamDeleteDataCommand"></bean>
                </entry>
                <entry key="V">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamValidateDataCommand"></bean>
                </entry>
                <entry key="R">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamReloadDataCommand">
                        <property name="dataExtractorService" ref="dataExtractorService" />
                        <property name="configurationService" ref="configurationService" />
                        <property name="nodeService" ref="nodeService" />
                    </bean>
                </entry>
                <entry key="S">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamSQLDataCommand"></bean>
                </entry>
                <entry key="C">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamCreateDataCommand"></bean>
                </entry>
            </map>
        </property>
    </bean>

    <bean id="dataExtractor10" class="org.jumpmind.symmetric.extract.csv.CsvExtractor10">
        <property name="parameterService" ref="parameterService" />
        <property name="tablePrefix" value="${sync.table.prefix}" />
        <property name="dictionary">
            <map>
                <entry key="I">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamInsertDataCommand"></bean>
                </entry>
                <entry key="U">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamUpdateDataCommand"></bean>
                </entry>
                <entry key="D">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamDeleteDataCommand"></bean>
                </entry>
                <entry key="V">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamValidateDataCommand"></bean>
                </entry>
                <entry key="R">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamReloadDataCommand">
                        <property name="dataExtractorService" ref="dataExtractorService" />
                        <property name="configurationService" ref="configurationService" />
                        <property name="nodeService" ref="nodeService" />
                    </bean>
                </entry>
                <entry key="S">
                    <bean class="org.jumpmind.symmetric.extract.csv.StreamSQLDataCommand"></bean>
                </entry>
            </map>
        </property>
    </bean>

    <bean id="upgradeService" class="org.jumpmind.symmetric.service.impl.UpgradeService">
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="parameterService" ref="parameterService" />
        <property name="nodeService" ref="nodeService" />
        <property name="upgradeTaskMap" ref="upgradeTaskMap" />
    </bean>

    <bean id="clusterService" class="org.jumpmind.symmetric.service.impl.ClusterService">
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="parameterService" ref="parameterService" />
        <property name="nodeService" ref="nodeService" />      
        <property name="sql" ref="clusterServiceSql"/> 
    </bean>

    <bean id="purgeService" class="org.jumpmind.symmetric.service.impl.PurgeService">
        <property name="jdbcTemplate" ref="jdbcTemplate" />
        <property name="sql" ref="purgeServiceSql" />
        <property name="parameterService" ref="parameterService" />
        <property name="clusterService" ref="clusterService" />
    </bean>

</beans>