<?xml version="1.0" encoding="UTF-8"?>
<chapter version="5.0" xml:id="ch03-concepts" xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:ns="http://docbook.org/ns/docbook"
         xmlns:mml="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml">
    <title>Concepts</title>
    <section>
        <title>Data Model</title>
        <para>
            <figure>
                <title>Data Model - Configuration</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="images/data-model-config.gif" format="GIF" />
                    </imageobject>
                </mediaobject>
            </figure>
        </para>
    </section>
    <section>
        <title>Node</title>
        <para>
            An instance of SymmetricDS that synchronizes data with one or more nodes. Each node
            has a unique identifier (nodeId) that is used when communicating, as well as a
            domain-specific identifier (externalId) that provides context within the local
            system.
        </para>
        <para>
            <table>
                <title>Node</title>
                <tgroup cols="6">
                    <colspec colwidth="115px" />
                    <colspec colwidth="65px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="40px" />
                    <colspec colwidth="250px" />
                    <thead>
                        <row>
                            <entry>Column Name</entry>
                            <entry>Type</entry>
                            <entry>Null</entry>
                            <entry>Key</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>node_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>PK</entry>
                            <entry></entry>
                            <entry>Unique identifier for a node</entry>
                        </row>
                        <row>
                            <entry>node_group_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>FK</entry>
                            <entry></entry>
                            <entry>
                                The node group that this node belongs to, such as "store"
                            </entry>
                        </row>
                        <row>
                            <entry>external_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                A domain-specific identifier for context within the local
                                system. For example, the retail store number.
                            </entry>
                        </row>
                        <row>
                            <entry>sync_enabled</entry>
                            <entry>booleanint</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry>0</entry>
                            <entry>
                                Indicates whether this node should be sent synchronization.
                                Disabled nodes are ignored by the triggers, so no entries are
                                made in DataEvent for the node.
                            </entry>
                        </row>
                        <row>
                            <entry>sync_url</entry>
                            <entry>varchar(2000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>The URL to contact the node for synchronization.</entry>
                        </row>
                        <row>
                            <entry>schema_version</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The version of the database schema this node manages. Useful for
                                specifying synchronization by version.
                            </entry>
                        </row>
                        <row>
                            <entry>symmetric_version</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>The version of SymmetricDS running at this node.</entry>
                        </row>
                        <row>
                            <entry>database_type</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The database product name at this node as reported by JDBC.
                            </entry>
                        </row>
                        <row>
                            <entry>database_version</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The database product version at this node as reported by JDBC.
                            </entry>
                        </row>
                        <row>
                            <entry>heartbeat_time</entry>
                            <entry>timestamp</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The last timestamp when the node sent a heartbeat, which is
                                attempted every ten minutes by default.
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
    </section>
    <section>
        <title>Node Security</title>
        <para>
            Security features like node passwords and open registration flag are stored in the
            NodeSecurity table.
        </para>
        <para>
            <table>
                <title>Node Security</title>
                <tgroup cols="6">
                    <colspec colwidth="115px" />
                    <colspec colwidth="65px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="40px" />
                    <colspec colwidth="250px" />
                    <thead>
                        <row>
                            <entry>Column Name</entry>
                            <entry>Type</entry>
                            <entry>Null</entry>
                            <entry>Key</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>node_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>PK FK</entry>
                            <entry></entry>
                            <entry>Unique identifier for a node</entry>
                        </row>
                        <row>
                            <entry>password</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The password used by the node to prove its identity during
                                synchronization.
                            </entry>
                        </row>
                        <row>
                            <entry>registration_enabled</entry>
                            <entry>booleanint</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>0</entry>
                            <entry>Indicates whether registration is open for this node.</entry>
                        </row>
                        <row>
                            <entry>registration_time</entry>
                            <entry>timestamp</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>The timestamp when this node was registered.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>

    </section>
    <section>
        <title>Node Group</title>
        <para>
            A category of Nodes that synchronizes data with one or more NodeGroups. A common use
            of NodeGroup is to describe a level in a hierarchy of data synchronization.
        </para>
        <para>
            <table>
                <title>Node Group</title>
                <tgroup cols="6">
                    <colspec colwidth="115px" />
                    <colspec colwidth="65px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="40px" />
                    <colspec colwidth="250px" />
                    <thead>
                        <row>
                            <entry>Column Name</entry>
                            <entry>Type</entry>
                            <entry>Null</entry>
                            <entry>Key</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>node_group_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>PK</entry>
                            <entry></entry>
                            <entry>
                                Unique identifier for a node group, usually named something
                                meaningful, like "store" or "warehouse".
                            </entry>
                        </row>
                        <row>
                            <entry>description</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>A description of this node group.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
    </section>
    <section>
        <title>Node Group Link</title>
        <para>
            A source NodeGroup sends its data updates to a target NodeGroup using a pull, push,
            or custom technique.
        </para>
        <para>
            <table>
                <title>Node Group Link</title>
                <tgroup cols="6">
                    <colspec colwidth="115px" />
                    <colspec colwidth="65px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="40px" />
                    <colspec colwidth="250px" />
                    <thead>
                        <row>
                            <entry>Column Name</entry>
                            <entry>Type</entry>
                            <entry>Null</entry>
                            <entry>Key</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>source_node_group_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>PK FK</entry>
                            <entry></entry>
                            <entry>The node group where data changes should be captured.</entry>
                        </row>
                        <row>
                            <entry>target_node_group_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>PK FK</entry>
                            <entry></entry>
                            <entry>The node group where data changes will be sent.</entry>
                        </row>
                        <row>
                            <entry>data_event_action</entry>
                            <entry>char(1)</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>W</entry>
                            <entry>
                                The notification scheme used to send data changes to the target
                                node group. (P = Push, W = Wait for Pull, X = Extract Listener)
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
    </section>
    <section>
        <title>Channel</title>
        <para>
            A category of data that can be synchronized independently of other Channels.
            Channels allow control over the type of data flowing and prevents one type of
            synchronization from contending with another.
        </para>
        <para>
            <table>
                <title>Channel</title>
                <tgroup cols="6">
                    <colspec colwidth="115px" />
                    <colspec colwidth="65px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="40px" />
                    <colspec colwidth="250px" />
                    <thead>
                        <row>
                            <entry>Column Name</entry>
                            <entry>Type</entry>
                            <entry>Null</entry>
                            <entry>Key</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>channel_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>PK</entry>
                            <entry></entry>
                            <entry>
                                A unique identifer, usually named something meaningful, like
                                "sales" or "inventory".
                            </entry>
                        </row>
                        <row>
                            <entry>processing_order</entry>
                            <entry>integer</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>1</entry>
                            <entry>Order of sequence to process channel data.</entry>
                        </row>
                        <row>
                            <entry>max_batch_size</entry>
                            <entry>integer</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>1000</entry>
                            <entry>
                                The maximum number of Data Events to process within a batch for
                                this channel.
                            </entry>
                        </row>
                        <row>
                            <entry>enabled</entry>
                            <entry>booleanint</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>1</entry>
                            <entry>Indicates whether channel is enabled or not.</entry>
                        </row>
                        <row>
                            <entry>description</entry>
                            <entry>varchar(1000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Description on the type of data carried in this channel.
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
    </section>
    <section>
        <title>Node Channel Control</title>
        <para>
            The Node Channel Control is used to ignore or suspend a channel. A channel that is
            ignored will have its Data Events batched and they will immediately be marked as
            "OK" without sending them. A channel that is suspended is skipped when batching Data
            Events.
        </para>
        <para>
            <table>
                <title>Node Channel Control</title>
                <tgroup cols="6">
                    <colspec colwidth="115px" />
                    <colspec colwidth="65px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="40px" />
                    <colspec colwidth="250px" />
                    <thead>
                        <row>
                            <entry>Column Name</entry>
                            <entry>Type</entry>
                            <entry>Null</entry>
                            <entry>Key</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>node_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>PK FK</entry>
                            <entry></entry>
                            <entry>Unique identifier for a node</entry>
                        </row>
                        <row>
                            <entry>channel_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry>PK FK</entry>
                            <entry></entry>
                            <entry>
                                A unique identifer, usually named something meaningful, like
                                "sales" or "inventory".
                            </entry>
                        </row>
                        <row>
                            <entry>suspend_enabled</entry>
                            <entry>booleanint</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry>0</entry>
                            <entry>
                                Indicates if this channel is suspended, which prevents its Data
                                Events from being batched.
                            </entry>
                        </row>
                        <row>
                            <entry>ignore_enabled</entry>
                            <entry>booleanint</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry>0</entry>
                            <entry>
                                Indicates if this channel is ignored, which marks its Data
                                Events as if they were actually processed.
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
    </section>
    <section>
        <title>Trigger</title>
        <para>
            The database triggers that capture changes in the database are automatically
            generated by SymmetricDS. Configuration of which triggers are generated and how they
            will behave is stored in the Trigger table.
        </para>
        <para>
            <table>
                <title>Trigger</title>
                <tgroup cols="6">
                    <colspec colwidth="115px" />
                    <colspec colwidth="65px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="25px" />
                    <colspec colwidth="40px" />
                    <colspec colwidth="250px" />
                    <thead>
                        <row>
                            <entry>Column Name</entry>
                            <entry>Type</entry>
                            <entry>Null</entry>
                            <entry>Key</entry>
                            <entry>Default</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>trigger_id</entry>
                            <entry>integer</entry>
                            <entry>N</entry>
                            <entry>PK</entry>
                            <entry></entry>
                            <entry>Unique identifier for a trigger.</entry>
                        </row>
                        <row>
                            <entry>source_schema_name</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>The schema name where the source table resides.</entry>
                        </row>
                        <row>
                            <entry>source_table_name</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The name of the source table that will have a trigger installed
                                to watch for data changes.
                            </entry>
                        </row>
                        <row>
                            <entry>target_schema_name</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>The schema name where the target table resides.</entry>
                        </row>
                        <row>
                            <entry>target_table_name</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The name of the target table that will have data changes
                                synchronized to it.
                            </entry>
                        </row>
                        <row>
                            <entry>source_node_group_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The node group that will install this trigger to watch for data
                                changes,
                            </entry>
                        </row>
                        <row>
                            <entry>target_node_group_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                The node group that will have data changes synchronized to it.
                            </entry>
                        </row>
                        <row>
                            <entry>channel_id</entry>
                            <entry>varchar(50)</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>The channel that data changes will flow through.</entry>
                        </row>
                        <row>
                            <entry>sync_on_update</entry>
                            <entry>booleanint</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>1</entry>
                            <entry>Whether or not to install an update trigger.</entry>
                        </row>
                        <row>
                            <entry>sync_on_insert</entry>
                            <entry>booleanint</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>1</entry>
                            <entry>Whether or not to install an insert trigger.</entry>
                        </row>
                        <row>
                            <entry>sync_on_delete</entry>
                            <entry>booleanint</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>1</entry>
                            <entry>Whether or not to install a delete trigger.</entry>
                        </row>
                        <row>
                            <entry>sync_on_incoming_batch</entry>
                            <entry>booleanint</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>0</entry>
                            <entry>
                                Whether or not an incoming batch that loads data into this table
                                should cause the triggers to capture Data Events. Be careful
                                turning this on, because an update loop is possible.
                            </entry>
                        </row>
                        <row>
                            <entry>name_for_update_trigger</entry>
                            <entry>varchar(30)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Override the default generated name for the update trigger.
                            </entry>
                        </row>
                        <row>
                            <entry>name_for_insert_trigger</entry>
                            <entry>varchar(30)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Override the default generated name for the insert trigger.
                            </entry>
                        </row>
                        <row>
                            <entry>name_for_delete_trigger</entry>
                            <entry>varchar(30)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Override the default generated name for the delete trigger.
                            </entry>
                        </row>
                        <row>
                            <entry>sync_on_update_condition</entry>
                            <entry>varchar(1000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Specify a condition for the update trigger firing using an
                                expression specific to the database.
                            </entry>
                        </row>
                        <row>
                            <entry>sync_on_insert_condition</entry>
                            <entry>varchar(1000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Specify a condition for the insert trigger firing using an
                                expression specific to the database.
                            </entry>
                        </row>
                        <row>
                            <entry>sync_on_delete_condition</entry>
                            <entry>varchar(1000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Specify a condition for the delete trigger firing using an
                                expression specific to the database.
                            </entry>
                        </row>
                        <row>
                            <entry>initial_load_select</entry>
                            <entry>varchar(1000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Specify a where-clause for an initial load of this table. The
                                table is aliased as "t".
                            </entry>
                        </row>
                        <row>
                            <entry>node_select</entry>
                            <entry>varchar(1000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Specify a where-clause for selecting the nodes that will receive
                                data changes. The node table is aliased as "c".
                            </entry>
                        </row>
                        <row>
                            <entry>tx_id_expression</entry>
                            <entry>varchar(1000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Override the default expression for the transaction identifier
                                that groups the data changes that were committed together.
                            </entry>
                        </row>
                        <row>
                            <entry>excluded_column_names</entry>
                            <entry>varchar(1000)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Specify a comma-delimited list of columns that should not be
                                synchronized from this table.
                            </entry>
                        </row>
                        <row>
                            <entry>initial_load_order</entry>
                            <entry>integer</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry>1</entry>
                            <entry>
                                Order sequence of this table when an initial load is sent to a
                                node.
                            </entry>
                        </row>
                        <row>
                            <entry>create_time</entry>
                            <entry>timestamp</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>Timestamp when this entry was created.</entry>
                        </row>
                        <row>
                            <entry>inactive_time</entry>
                            <entry>timestamp</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>
                                Timestamp when this entry was inactivated, which stops capturing
                                of data changes.
                            </entry>
                        </row>
                        <row>
                            <entry>last_updated_by</entry>
                            <entry>varchar(50)</entry>
                            <entry>Y</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>The user who last updated this entry.</entry>
                        </row>
                        <row>
                            <entry>last_updated_time</entry>
                            <entry>timestamp</entry>
                            <entry>N</entry>
                            <entry></entry>
                            <entry></entry>
                            <entry>Timestamp when a user last updated this entry.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
    </section>
</chapter>
