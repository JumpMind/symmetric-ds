<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:util="http://www.springframework.org/schema/util"
  xsi:schemaLocation="    
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd"
  default-lazy-init="true">

  <util:map id="registrationServiceSql">
    <entry key="findNodeToRegisterSql">
      <value>
        select min(c.node_id) from ${sync.table.prefix}_node c inner join
        ${sync.table.prefix}_node_security s on c.node_id = s.node_id where s.registration_enabled =
        1 and c.node_group_id = ? and c.external_id = ?
      </value>
    </entry>
    <entry key="registerNodeSql">
      <value>
        update ${sync.table.prefix}_node set sync_enabled = 1, sync_url = ?, schema_version = ?,
        database_type = ?, database_version = ?, symmetric_version = ? where node_id = ?
      </value>
    </entry>
    <entry key="registerNodeSecuritySql">
      <value>
        update ${sync.table.prefix}_node_security set registration_enabled = 0, registration_time =
        current_timestamp where node_id = ?
      </value>
    </entry>
    <entry key="reopenRegistrationSql">
      <value>
        update ${sync.table.prefix}_node_security set node_password = ?, registration_enabled = 1,
        registration_time = null where node_id = ?
      </value>
    </entry>
    <entry key="openRegistrationNodeSql">
      <value>
        insert into ${sync.table.prefix}_node (node_id, node_group_id, external_id) values (?, ?, ?)
      </value>
    </entry>
    <entry key="openRegistrationNodeSecuritySql">
      <value>
        insert into ${sync.table.prefix}_node_security (node_id, node_password,
        registration_enabled) values (?, ?, 1)
      </value>
    </entry>

  </util:map>

</beans>