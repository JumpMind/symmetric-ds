<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:util="http://www.springframework.org/schema/util" xmlns:task="http://www.springframework.org/schema/task"
    xsi:schemaLocation="
http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd    
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd"
    default-lazy-init="true">

    <task:scheduler id="symmetricScheduler" pool-size="20" />

    <bean id="randomTimeSlot" class="org.jumpmind.symmetric.util.RandomTimeSlot">
        <property name="parameterService" ref="parameterService" />
    </bean>

    <bean id="jobManager" class="org.jumpmind.symmetric.job.JobManager">
        <property name="parameterService" ref="parameterService" />
        <property name="taskScheduler" ref="symmetricScheduler" />
        <property name="randomTimeSlot" ref="randomTimeSlot" />
        <property name="jobs">
            <list>
                <ref bean="job.routing" />
                <ref bean="job.push" />
                <ref bean="job.pull" />
                <ref bean="job.purge" />
                <ref bean="job.stat.flush" />
                <ref bean="job.synctriggers" />
                <ref bean="job.heartbeat" />
                <ref bean="job.watchdog" />
            </list>
        </property>
    </bean>

    <bean id="job.abstract" abstract="true" class="org.jumpmind.symmetric.job.AbstractJob">
        <property name="parameterService" ref="parameterService" />
        <property name="dataSource" ref="dataSource" />
        <property name="registrationService" ref="registrationService" />
    </bean>

    <bean id="job.routing" parent="job.abstract" class="org.jumpmind.symmetric.job.RouterJob"
        scope="prototype">
        <property name="routingService" ref="routingService" />
    </bean>

    <bean id="job.push" parent="job.abstract" class="org.jumpmind.symmetric.job.PushJob" scope="prototype">
        <property name="pushService" ref="pushService" />
    </bean>

    <bean id="job.pull" parent="job.abstract" class="org.jumpmind.symmetric.job.PullJob" scope="prototype">
        <property name="requiresRegistration" value="false" />
        <property name="pullService" ref="pullService" />
        <property name="nodeService" ref="nodeService" />
    </bean>

    <bean id="job.purge" parent="job.abstract" class="org.jumpmind.symmetric.job.PurgeJob">
        <property name="purgeService" ref="purgeService" />
    </bean>

    <bean id="job.stat.flush" parent="job.abstract" class="org.jumpmind.symmetric.job.StatisticFlushJob">
        <property name="statisticManager" ref="statisticManager" />
    </bean>

    <bean id="job.synctriggers" parent="job.abstract" class="org.jumpmind.symmetric.job.SyncTriggersJob">
        <property name="triggerRouterService" ref="triggerRouterService" />
    </bean>

    <bean id="job.heartbeat" parent="job.abstract" class="org.jumpmind.symmetric.job.HeartbeatJob">
        <property name="requiresRegistration" value="false" />
        <property name="dataService" ref="dataService" />
        <property name="clusterService" ref="clusterService" />
    </bean>

    <bean id="job.watchdog" parent="job.abstract" class="org.jumpmind.symmetric.job.WatchdogJob">
        <property name="requiresRegistration" value="false" />
        <property name="nodeService" ref="nodeService" />
    </bean>

</beans>